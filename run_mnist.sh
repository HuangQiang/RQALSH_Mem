#!/bin/bash
make
make clean

# ------------------------------------------------------------------------------
#  Parameters
# ------------------------------------------------------------------------------
dname=Mnist
n=59000
qn=1000
d=50
c=2.0
dPath=data/${dname}/${dname}
oPath=results${c}/${dname}/

# ------------------------------------------------------------------------------
#  Ground Truth 
# ------------------------------------------------------------------------------
./rqalsh -alg 0 -n ${n} -qn ${qn} -d ${d} -ds ${dPath}.ds -qs ${dPath}.q \
    -ts ${dPath}.fn${c}

# ------------------------------------------------------------------------------
#  ML_RQALSH
# ------------------------------------------------------------------------------
./rqalsh -alg 1 -n ${n} -qn ${qn} -d ${d} -c ${c} -ds ${dPath}.ds \
    -qs ${dPath}.q -ts ${dPath}.fn${c} -op ${oPath}

# ------------------------------------------------------------------------------
#  RQALSH*
# ------------------------------------------------------------------------------
L_list=(2000 1000 800 500 400 200 100 80 50 40 20 10 8 5 4 2)
M_list=(2 4 5 8 10 20 40 50 80 100 200 400 500 800 1000 2000)
length=`expr ${#L_list[*]} - 1`

for j in $(seq 0 ${length})
do 
    L=${L_list[j]}
    M=${M_list[j]}

    ./rqalsh -alg 2 -n ${n} -qn ${qn} -d ${d} -L ${L} -M ${M} -c ${c} \
        -ds ${dPath}.ds -qs ${dPath}.q -ts ${dPath}.fn${c} -op ${oPath}
done

# ------------------------------------------------------------------------------
#  RQALSH
# ------------------------------------------------------------------------------
./rqalsh -alg 3 -n ${n} -qn ${qn} -d ${d} -c ${c} -ds ${dPath}.ds \
    -qs ${dPath}.q -ts ${dPath}.fn${c} -op ${oPath}

# ------------------------------------------------------------------------------
#  Drusilla Select
# ------------------------------------------------------------------------------
L_list=(2000 1000 800 500 400 200 100 80 50 40 20 10 8 5 4 2)
M_list=(2 4 5 8 10 20 40 50 80 100 200 400 500 800 1000 2000)

for j in $(seq 0 ${length})
do 
    L=${L_list[j]}
    M=${M_list[j]}
    
    ./rqalsh -alg 4 -n ${n} -qn ${qn} -d ${d} -L ${L} -M ${M} -ds ${dPath}.ds \
        -qs ${dPath}.q -ts ${dPath}.fn${c} -op ${oPath}
done

# ------------------------------------------------------------------------------
#  QDAFN
# ------------------------------------------------------------------------------
./rqalsh -alg 5 -n ${n} -qn ${qn} -d ${d} -L 0 -M 0 -c ${c} -ds ${dPath}.ds \
    -qs ${dPath}.q -ts ${dPath}.fn${c} -op ${oPath}

# ------------------------------------------------------------------------------
#  Linear Scan
# ------------------------------------------------------------------------------
./rqalsh -alg 6 -n ${n} -qn ${qn} -d ${d} -ds ${dPath}.ds -qs ${dPath}.q \
    -ts ${dPath}.fn${c} -op ${oPath}
